<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit the alternative model for bivariate random-effects meta-analysis — riley • metamisc</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit the alternative model for bivariate random-effects meta-analysis — riley"><meta name="description" content="This function fits the alternative model for bivariate random-effects meta-analysis when the within-study correlations
are unknown. This bivariate model was proposed by Riley et al. (2008) and is similar to the general bivariate
random-effects model (van Houwelingen et al. 2002), but includes an overall correlation parameter rather than
separating the (usually unknown) within- and between-study correlation. As a consequence, the alternative model
is not fully hierarchical, and estimates of additional variation beyond sampling error (psi) are not
directly equivalent to the between-study variation (tau) from the general model. This model is particularly
useful when there is large within-study variability, few primary studies are available or the general model
estimates the between-study correlation as 1 or -1."><meta property="og:description" content="This function fits the alternative model for bivariate random-effects meta-analysis when the within-study correlations
are unknown. This bivariate model was proposed by Riley et al. (2008) and is similar to the general bivariate
random-effects model (van Houwelingen et al. 2002), but includes an overall correlation parameter rather than
separating the (usually unknown) within- and between-study correlation. As a consequence, the alternative model
is not fully hierarchical, and estimates of additional variation beyond sampling error (psi) are not
directly equivalent to the between-study variation (tau) from the general model. This model is particularly
useful when there is large within-study variability, few primary studies are available or the general model
estimates the between-study correlation as 1 or -1."><meta property="og:image" content="https://smartdata-analysis-and-statistics.github.io/metamisc/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">metamisc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/ma-pf.html">Meta-analysis of prognostic factors</a></li>
    <li><a class="dropdown-item" href="../articles/ma-pm.html">Meta-analysis of prediction model performance</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/smartdata-analysis-and-statistics/metamisc/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Fit the alternative model for bivariate random-effects meta-analysis</h1>
      <small class="dont-index">Source: <a href="https://github.com/smartdata-analysis-and-statistics/metamisc/blob/main/R/riley.r" class="external-link"><code>R/riley.r</code></a></small>
      <div class="d-none name"><code>riley.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function fits the alternative model for bivariate random-effects meta-analysis when the within-study correlations
are unknown. This bivariate model was proposed by Riley et al. (2008) and is similar to the general bivariate
random-effects model (van Houwelingen et al. 2002), but includes an overall correlation parameter rather than
separating the (usually unknown) within- and between-study correlation. As a consequence, the alternative model
is not fully hierarchical, and estimates of additional variation beyond sampling error (<code>psi</code>) are not
directly equivalent to the between-study variation (<code>tau</code>) from the general model. This model is particularly
useful when there is large within-study variability, few primary studies are available or the general model
estimates the between-study correlation as 1 or -1.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">riley</span><span class="op">(</span><span class="va">X</span>, <span class="va">slab</span>, optimization <span class="op">=</span> <span class="st">"Nelder-Mead"</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">pars</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>data frame containing integer variables <code>Y1</code>, <code>vars1</code>, <code>Y2</code> and <code>vars2</code>,
where the columns <code>Y1</code> and <code>Y2</code> represent the effect sizes of outcome 1 and, respectively, outcome 2. The columns
<code>vars1</code> and <code>vars2</code> represent the error variances of <code>Y1</code> and, respectively, <code>Y2</code>. Alternatively,
when considering a meta-analysis of diagnostic test accuracy data, the columns <code>TP</code>, <code>FN</code>, <code>FP</code> and
<code>TN</code> may be specified. Corresponding values then represent the number of true positives, the number of false negatives,
the number of false positives and, respectively, the number of true negatives.</p></dd>


<dt id="arg-slab">slab<a class="anchor" aria-label="anchor" href="#arg-slab"></a></dt>
<dd><p>Optional vector specifying the label for each study</p></dd>


<dt id="arg-optimization">optimization<a class="anchor" aria-label="anchor" href="#arg-optimization"></a></dt>
<dd><p>The optimization method that should be used for minimizing the negative (restricted)
log-likelihood function. The default method is an implementation of that of Nelder and Mead (1965),
that uses only function values and is robust but relatively slow. Other methods are described in <a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a>.</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>A list of control parameters to pass to <a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a>.</p></dd>


<dt id="arg-pars">pars<a class="anchor" aria-label="anchor" href="#arg-pars"></a></dt>
<dd><p>List with additional arguments. The width of confidence, credibility and prediction intervals is
defined by <code>level</code> (defaults to 0.95).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments to be passed on to other functions. See "Details" for more information.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of the class <code>riley</code> for which many standard methods are available. A warning message is
casted when the Hessian matrix contains negative eigenvalues, which implies that the identified solution is a
saddle point and thus not optimal.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Parameters are estimated by iteratively maximizing the restriced log-likelihood using the Newton-Raphson procedure.
The results from a univariate random-effects meta-analysis with a method-of-moments estimator are used as starting
values for <code>beta1</code>, <code>beta2</code>, <code>psi1</code> and <code>psi2</code> in the <code>optim</code> command. Standard errors for all parameters are obtained
from the inverse Hessian matrix.</p>
<div class="section">
<h3 id="meta-analysis-of-effect-sizes">Meta-analysis of effect sizes<a class="anchor" aria-label="anchor" href="#meta-analysis-of-effect-sizes"></a></h3>
<p>The following parameters are estimated by iteratively maximizing the restriced log-likelihood using the Newton-Raphson
procedure: pooled effect size for outcome 1 (<code>beta1</code>), pooled effect size for outcome 2 (<code>beta2</code>),
additional variation of <code>beta1</code> beyond sampling error (<code>psi1</code>), additional variation of <code>beta2</code>
beyond sampling error (<code>psi2</code>) and the correlation <code>rho</code> between <code>psi1</code> and <code>psi2</code>.</p>
</div>

<div class="section">
<h3 id="meta-analysis-of-diagnostic-test-accuracy">Meta-analysis of diagnostic test accuracy<a class="anchor" aria-label="anchor" href="#meta-analysis-of-diagnostic-test-accuracy"></a></h3>
<p>Although the model can also be used for diagnostic test accuracy data when substantial within-study correlations
are expected, assuming zero within-study correlations (i.e. applying Reitsma's approach) is usually justified
(Reitsma et al. 2005, Daniels and Hughes 1997, Korn et al. 2005, Thompson et al. 2005, Van Houwelingen et al. 2002).</p>
<p>A logit transformation is applied to the sensitivities ans false positive rates of each study, in order to meet the normality
assumptions. When zero cell counts occur, continuity corrections may be required. The correction value can be specified using
<code>correction</code> (defaults to 0.5). Further, when the argument <code>correction.control</code> is set to <code>"all"</code>
(the default) the continuity correction is added to the whole data if only one cell in one study is zero.
If <code>correction.control="single"</code> the correction is only applied to rows of the data which have a zero.</p>
<p>The following parameters are estimated: logit of sensitivity (<code>beta1</code>), logit of false positive rate (<code>beta2</code>),
additional variation of <code>beta1</code> beyond sampling error (<code>psi1</code>), additional variation of <code>beta2</code> beyond
sampling error (<code>psi2</code>) and the correlation (<code>rho</code>) between <code>psi1</code> and <code>psi2</code>.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The overall correlation parameter <code>rho</code> is transformed during estimation to ensure that corresponding values
remain between -1 and 1. The transformed correlation <code>rhoT</code> is given as <code>logit((rho+1)/2)</code>. During optimization,
the starting value for <code>rhoT</code> is set to 0.  The standard error of <code>rho</code> is derived from <code>rhoT</code> using
the Delta method. Similarly, the Delta methods is used to derive the standard error of the sensitivity and false
positive rate from <code>beta1</code> and, respectively, <code>beta2</code>.</p>
<p>Algorithms for dealing with missing data are currently not implemented, but Bayesian approaches will become
available in later versions.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p>Korn EL, Albert PS, McShane LM. Assessing surrogates as trial endpoints using mixed models.
<em>Statistics in Medicine</em> 2005; <b>24</b>: 163–182.</p></li>
<li><p>Nelder JA, Mead R. A simplex algorithm for function minimization. <em>Computer Journal</em> (1965); <b>7</b>: 308–313.</p></li>
<li><p>Reitsma J, Glas A, Rutjes A, Scholten R, Bossuyt P, Zwinderman A. Bivariate analysis of sensitivity and
specificity produces informative summary measures in diagnostic reviews. <em>Journal of Clinical Epidemiology</em> 2005;
<b>58</b>: 982–990.</p></li>
<li><p>Riley RD, Thompson JR, Abrams KR. An alternative model for bivariate random-effects meta-analysis when
the within-study correlations are unknown. <em>Biostatistics</em> 2008; <b>9</b>: 172–186.</p></li>
<li><p>Thompson JR, Minelli C, Abrams KR, Tobin MD, Riley RD. Meta-analysis of genetic studies using mendelian
randomization–a multivariate approach. <em>Statistics in Medicine</em> 2005; <b>24</b>: 2241–2254.</p></li>
<li><p>van Houwelingen HC, Arends LR, Stijnen T. Advanced methods in meta-analysis: multivariate approach and
meta-regression. <em>Statistics in Medicine</em> 2002; <b>21</b>: 589–624.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Thomas Debray &lt;thomas.debray@gmail.com&gt;</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Scheidler</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Daniels</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Kertai</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Meta-analysis of potential surrogate markers data</span></span></span>
<span class="r-in"><span><span class="co"># The results obtained by Riley (2008) were as follows:</span></span></span>
<span class="r-in"><span><span class="co"># beta1 = -0.042 (SE = 0.063),</span></span></span>
<span class="r-in"><span><span class="co"># beta2 = 14.072 (SE = 4.871)</span></span></span>
<span class="r-in"><span><span class="co"># rho   = -0.759</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu">riley</span><span class="op">(</span><span class="va">Daniels</span><span class="op">)</span> <span class="co">#maxit reached, try again with more iterations</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu">riley</span><span class="op">(</span><span class="va">Daniels</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>maxit<span class="op">=</span><span class="fl">10000</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $call</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> riley.default(X = Daniels, control = list(maxit = 10000))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $confints</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Estimate         SE       2.5 %     97.5 %</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta1  0.005298983 0.06479973 -0.12170616  0.1323041</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta2 13.505678310 4.99256719  3.72042644 23.2909302</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> psi1   0.134785102 0.09190903 -0.04535329  0.3149235</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> psi2  18.076027226 4.00992798 10.21671280 25.9353417</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho   -0.748689375 0.15266774 -0.89430728 -0.4596724</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "summary.riley"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Meta-analysis of prognostic test studies</span></span></span>
<span class="r-in"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu">riley</span><span class="op">(</span><span class="va">Kertai</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> riley.default(X = Kertai)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      beta1      beta2       psi1       psi2        rho </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.8164679 -0.9715821  0.3499043  0.7692122  0.1537878 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Degrees of Freedom: 9 Residual</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Meta-analysis of computed tomography data </span></span></span>
<span class="r-in"><span><span class="va">ds</span> <span class="op">&lt;-</span> <span class="va">Scheidler</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">Scheidler</span><span class="op">$</span><span class="va">modality</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">fit3</span> <span class="op">&lt;-</span> <span class="fu">riley</span><span class="op">(</span><span class="va">ds</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit3</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> riley.default(X = ds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       beta1       beta2        psi1        psi2         rho </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.01731291 -2.32166611  0.71181410  0.38103153  0.70119871 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Degrees of Freedom: 29 Residual</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Debray, Valentijn de Jong.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

