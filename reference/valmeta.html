<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function provides summary estimates for the concordance statistic, 
the total observed-expected ratio or the calibration slope. Where 
appropriate, data transformations are applied and missing information 
is derived from available quantities. Unless specified otherwise, all 
meta-analysis models assume random effects and are fitted using restricted 
maximum likelihood estimation with the metafor package 
(Viechtbauer 2010). Further, confidence intervals for the average 
performance are based on the Hartung-Knapp-Sidik-Jonkman method. 
When conducting a Bayesian meta-analysis, the R packages runjags and 
rjags must be installed."><title>Meta-analysis of prediction model performance — valmeta • metamisc</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Meta-analysis of prediction model performance — valmeta"><meta property="og:description" content="This function provides summary estimates for the concordance statistic, 
the total observed-expected ratio or the calibration slope. Where 
appropriate, data transformations are applied and missing information 
is derived from available quantities. Unless specified otherwise, all 
meta-analysis models assume random effects and are fitted using restricted 
maximum likelihood estimation with the metafor package 
(Viechtbauer 2010). Further, confidence intervals for the average 
performance are based on the Hartung-Knapp-Sidik-Jonkman method. 
When conducting a Bayesian meta-analysis, the R packages runjags and 
rjags must be installed."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">metamisc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/ma-pm.html">ma-pm</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/smartdata-analysis-and-statistics/metamisc/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Meta-analysis of prediction model performance</h1>
      <small class="dont-index">Source: <a href="https://github.com/smartdata-analysis-and-statistics/metamisc/blob/HEAD/R/valmeta.r" class="external-link"><code>R/valmeta.r</code></a></small>
      <div class="d-none name"><code>valmeta.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function provides summary estimates for the concordance statistic, 
the total observed-expected ratio or the calibration slope. Where 
appropriate, data transformations are applied and missing information 
is derived from available quantities. Unless specified otherwise, all 
meta-analysis models assume random effects and are fitted using restricted 
maximum likelihood estimation with the <span class="pkg">metafor</span> package 
(Viechtbauer 2010). Further, confidence intervals for the average 
performance are based on the Hartung-Knapp-Sidik-Jonkman method. 
When conducting a Bayesian meta-analysis, the R packages <span class="pkg">runjags</span> and 
<span class="pkg">rjags</span> must be installed.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">valmeta</span><span class="op">(</span></span>
<span>  measure <span class="op">=</span> <span class="st">"cstat"</span>,</span>
<span>  <span class="va">cstat</span>,</span>
<span>  <span class="va">cstat.se</span>,</span>
<span>  <span class="va">cstat.cilb</span>,</span>
<span>  <span class="va">cstat.ciub</span>,</span>
<span>  <span class="va">cstat.cilv</span>,</span>
<span>  <span class="va">sd.LP</span>,</span>
<span>  <span class="va">OE</span>,</span>
<span>  <span class="va">OE.se</span>,</span>
<span>  <span class="va">OE.cilb</span>,</span>
<span>  <span class="va">OE.ciub</span>,</span>
<span>  <span class="va">OE.cilv</span>,</span>
<span>  <span class="va">citl</span>,</span>
<span>  <span class="va">citl.se</span>,</span>
<span>  <span class="va">N</span>,</span>
<span>  <span class="va">O</span>,</span>
<span>  <span class="va">E</span>,</span>
<span>  <span class="va">Po</span>,</span>
<span>  <span class="va">Po.se</span>,</span>
<span>  <span class="va">Pe</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"REML"</span>,</span>
<span>  test <span class="op">=</span> <span class="st">"knha"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">slab</span>,</span>
<span>  n.chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  <span class="va">pars</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>measure</dt>
<dd><p>A character string indicating which summary performance 
measure should be calculated. Options are
<code>"cstat"</code> (meta-analysis of the concordance statistic) and <code>"OE"</code> 
(meta-analysis of the total observed-expected ratio). See `Details' for more information.</p></dd>


<dt>cstat</dt>
<dd><p>Optional vector with the estimated c-statistic for each valiation</p></dd>


<dt>cstat.se</dt>
<dd><p>Optional vector with the standard error of the estimated c-statistics</p></dd>


<dt>cstat.cilb</dt>
<dd><p>Optional vector to specify the lower limits of the confidence interval.</p></dd>


<dt>cstat.ciub</dt>
<dd><p>Optional vector to specify the upper limits of the confidence interval.</p></dd>


<dt>cstat.cilv</dt>
<dd><p>Optional vector to specify the levels of aformentioned confidence interval limits. 
(default: 0.95, which corresponds to the 95% confidence interval).</p></dd>


<dt>sd.LP</dt>
<dd><p>Optional vector with the standard deviation of the linear predictor (prognostic index)</p></dd>


<dt>OE</dt>
<dd><p>Optional vector with the estimated ratio of total observed versus total expected events</p></dd>


<dt>OE.se</dt>
<dd><p>Optional vector with the standard errors of the estimated O:E ratios</p></dd>


<dt>OE.cilb</dt>
<dd><p>Optional vector to specify the lower limits of the confidence interval for <code>OE</code>.</p></dd>


<dt>OE.ciub</dt>
<dd><p>Optional vector to specify the upper limits of the confidence interval for <code>OE</code>.</p></dd>


<dt>OE.cilv</dt>
<dd><p>Optional vector to specify the levels of aformentioned confidence interval limits. 
(default: 0.95, which corresponds to the 95% confidence interval).</p></dd>


<dt>citl</dt>
<dd><p>Optional vector with the estimated calibration-in-the-large for each valiation</p></dd>


<dt>citl.se</dt>
<dd><p>Optional vector with the standard error of the estimated calibration-in-the-large statistics</p></dd>


<dt>N</dt>
<dd><p>Optional vector with the total number of participants for each valiation</p></dd>


<dt>O</dt>
<dd><p>Optional vector with the total number of observed events for each valiation
(if specified, during time <code>t.val</code>)</p></dd>


<dt>E</dt>
<dd><p>Optional vector with the total number of expected events for each valiation 
(if specified, during time <code>t.val</code>)</p></dd>


<dt>Po</dt>
<dd><p>Optional vector with the (cumulative) observed event probability for each valiation
(if specified, during time <code>t.val</code>)</p></dd>


<dt>Po.se</dt>
<dd><p>Optional vector with the standard errors of <code>Po</code>.</p></dd>


<dt>Pe</dt>
<dd><p>Optional vector with the (cumulative) expected event probability for each validation
(if specified, during time <code>t.val</code>)</p></dd>


<dt>data</dt>
<dd><p>optional data frame containing the variables given to the arguments above.</p></dd>


<dt>method</dt>
<dd><p>Character string specifying whether a fixed- or a random-effects model should be fitted. 
A fixed-effects model is fitted when using <code>method="FE"</code>. Random-effects models are fitted by setting method 
equal to one of the following: <code>"REML"</code> (Default), <code>"DL"</code>, <code>"HE"</code>, <code>"SJ"</code>, <code>"ML"</code>, 
<code>"EB"</code>, <code>"HS"</code>, <code>"GENQ"</code> or <code>"BAYES"</code>. See 'Details'.</p></dd>


<dt>test</dt>
<dd><p>Optional character string specifying how test statistics and confidence intervals for the fixed effects 
should be computed. By default (<code>test="knha"</code>), the method by Knapp and Hartung (2003) is used for 
adjusting test statistics and confidence intervals. Type '<code><a href="https://wviechtb.github.io/metafor/reference/rma.uni.html" class="external-link">?rma</a></code>' for more details.</p></dd>


<dt>verbose</dt>
<dd><p>If TRUE then messages generated during the fitting process will be displayed.</p></dd>


<dt>slab</dt>
<dd><p>Optional vector specifying the label for each study</p></dd>


<dt>n.chains</dt>
<dd><p>Optional numeric specifying the number of chains to use in the Gibbs sampler 
(if <code>method="BAYES"</code>). More chains will improve the sensitivity of the convergence diagnostic, but will 
cause the simulation to run more slowly. The default number of chains is 4.</p></dd>


<dt>pars</dt>
<dd><p>A list with additional arguments.  See 'Details' for more information. The following parameters configure the MCMC sampling procedure:
<code>hp.mu.mean</code> (mean of the prior distribution of the random effects model, defaults to 0), 
<code>hp.mu.var</code> (variance of the prior distribution of the random effects model, defaults to 1000), 
<code>hp.tau.min</code> (minimum value for the between-study standard deviation, defaults to 0), 
<code>hp.tau.max</code> (maximum value for the between-study standard deviation, defaults to 2), 
<code>hp.tau.sigma</code> (standard deviation of the prior distribution for the between-study standard-deviation), 
<code>hp.tau.dist</code> (prior distribution for the between-study standard-deviation. Defaults to <code>"dunif"</code>), 
<code>hp.tau.df</code> (degrees of freedom for the prior distribution for the between-study standard-deviation. 
Defaults to 3). Other arguments are <code>method.restore.c.se</code> (method for restoring missing estimates for the standard error 
of the c-statistic. See <code><a href="ccalc.html">ccalc</a></code> for more information), 
<code>model.cstat</code> (The likelihood/link for modeling the c-statistic; see "Details"), 
<code>model.oe</code> (The likelihood/link for modeling the O:E ratio; see "Details"),
<code>seed</code> (an integer to indicate the random seed).</p></dd>


<dt>...</dt>
<dd><p>Additional arguments that are passed to <span class="pkg">rma</span> or <span class="pkg">runjags</span> (if <code>method="BAYES"</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of class <code>valmeta</code> with the following elements:</p><dl><dt>"data"</dt>
<dd><p>array with (transformed) data used for meta-analysis, 
 and method(s) used for restoring missing information.</p></dd>

 <dt>"measure"</dt>
<dd><p>character string specifying the performance measure that 
 has been meta-analysed.</p></dd>

 <dt>"method"</dt>
<dd><p>character string specifying the meta-analysis method.</p></dd>

 <dt>"model"</dt>
<dd><p>character string specifying the meta-analysis model 
 (link function).</p></dd>

 <dt>"est"</dt>
<dd><p>summary estimate for the performance statistic. For Bayesian 
 meta-analysis, the posterior median is returned.</p></dd>

 <dt>"ci.lb"</dt>
<dd><p>lower bound of the confidence (or credibility) interval of 
 the summary performance estimate.</p></dd>

 <dt>"ci.ub"</dt>
<dd><p>upper bound of the confidence (or credibility) interval of 
 the summary performance estimate.</p></dd>

 <dt>"pi.lb"</dt>
<dd><p>lower bound of the (approximate) prediction interval of the 
 summary performance estimate.</p></dd>

 <dt>"pi.ub"</dt>
<dd><p>upper bound of the (approximate) prediction interval of the 
 summary performance estimate.</p></dd>

 <dt>"fit"</dt>
<dd><p>the full results from the fitted model.</p></dd>

 <dt>"slab"</dt>
<dd><p>vector specifying the label of each study.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    
<div class="section">
<h3 id="meta-analysis-of-the-concordance-statistic">Meta-analysis of the concordance statistic<a class="anchor" aria-label="anchor" href="#meta-analysis-of-the-concordance-statistic"></a></h3>
<p>A summary estimate for the concorcance (c-) statistic can be obtained by specifying <code>measure="cstat"</code>.
The c-statistic is a measure of discrimination, and indicates the ability of a prediction model to 
distinguish between patients developing and not developing the outcome. The c-statistic typically ranges 
from 0.5 (no discriminative ability) to 1 (perfect discriminative ability). When missing, the c-statistic 
and/or its standard error are derived from other reported information. 
See <code><a href="ccalc.html">ccalc</a></code> for more information.</p>
<p>By default, it is assumed that the logit of the c-statistic is Normally distributed within and across studies
(<code>pars$model.cstat = "normal/logit"</code>). Alternatively, it is possible to assume that the raw c-statistic 
is Normally distributed across studies <code>pars$model.cstat = "normal/identity"</code>.</p>
</div> 

<div class="section">
<h3 id="meta-analysis-of-the-total-observed-versus-expected-ratio">Meta-analysis of the total observed versus expected ratio<a class="anchor" aria-label="anchor" href="#meta-analysis-of-the-total-observed-versus-expected-ratio"></a></h3>
<p>A summary estimate for the total observed versus expected (O:E) ratio can be 
obtained by specifying <code>measure="OE"</code>. The total O:E ratio provides a 
rough indication of the overall model calibration (across the entire range 
of predicted risks). When missing, the total O:E ratio and/or its standard 
error are derived from other reported information. See <code><a href="oecalc.html">oecalc</a></code> 
for more information.</p>
<p>For frequentist meta-analysis, within-study variation can either be modeled 
using a Normal (<code>model.oe = "normal/log"</code> or 
<code>model.oe = "normal/identity"</code>) or a Poisson distribution 
(<code>model.oe = "poisson/log"</code>).</p>
<p>When performing a Bayesian meta-analysis, all data are modeled using a 
one-stage random effects (hierarchical related regression) model.
In particular, a binomial distribution (if <code>O</code>, <code>E</code> and 
<code>N</code> is known), a Poisson distribution (if only <code>O</code> and 
<code>E</code> are known) or a Normal distribution (if <code>OE</code> and 
<code>OE.se</code> or <code>OE.95CI</code> are known) is selected separately for 
each study.</p>
</div>

<div class="section">
<h3 id="bayesian-meta-analysis">Bayesian meta-analysis<a class="anchor" aria-label="anchor" href="#bayesian-meta-analysis"></a></h3>
<p>All Bayesian meta-analysis models assume the presence of random effects. 
Summary estimates are based on the posterior mean. Credibility and 
prediction intervals are directly obtained from the corresponding posterior 
quantiles.</p>
<p>The prior distribution for the (transformed) performance estimate is modeled 
using a Normal distribution, with mean <code>hp.mu.mean</code> (defaults to 0) 
and variance <code>hp.mu.var</code> (defaults to 1000). 
For meta-analysis of the total O:E ratio, the maximum value for 
<code>hp.mu.var</code> is 100.</p>
<p>By default, the prior distribution for the between-study standard deviation 
is modeled using a uniform distribution (<code>hp.tau.dist="dunif"</code>), 
with boundaries <code>hp.tau.min</code> and <code>hp.tau.max</code>. Alternative choices 
are a truncated Student-t distribution (<code>hp.tau.dist="dhalft"</code>) with a 
mean of <code>hp.tau.mean</code>, a standard deviation of <code>hp.tau.sigma</code> and 
<code>hp.tau.df</code> degrees of freedom. This distribution is again restricted 
to the range <code>hp.tau.min</code> to <code>hp.tau.max</code>.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The width of calculated confidence, credibility and prediction 
intervals can be specified using <code>level</code> in the <code>pars</code> argument 
(defaults to 0.95).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Debray TPA, Damen JAAG, Snell KIE, Ensor J, Hooft L, Reitsma JB, et al. 
A guide to systematic review and meta-analysis of prediction model 
performance. <em>BMJ</em>. 2017;<b>356</b>:i6460. <a href="https://doi.org/10.1136/bmj.i6460" class="external-link">doi:10.1136/bmj.i6460</a></p>
<p>Debray TPA, Damen JAAG, Riley R, Snell KIE, Reitsma JB, Hooft L, et al. 
A framework for meta-analysis of prediction model studies with binary and 
time-to-event outcomes. <em>Stat Methods Med Res</em>. 2019;<b>28</b>:2768--86. 
<a href="https://doi.org/10.1177/0962280218785504" class="external-link">doi:10.1177/0962280218785504</a></p>
<p>Riley RD, Tierney JF, Stewart LA. Individual participant data meta-analysis: 
a handbook for healthcare research. Hoboken, NJ: Wiley; 2021. 
ISBN: 978-1-119-33372-2.</p>
<p>Steyerberg EW, Nieboer D, Debray TPA, van Houwelingen HC. Assessment of 
heterogeneity in an individual participant data meta-analysis of prediction 
models: An overview and illustration. <em>Stat Med</em>. 2019;
<b>38</b>:4290--309. <a href="https://doi.org/10.1002/sim.8296" class="external-link">doi:10.1002/sim.8296</a></p>
<p>Viechtbauer W. Conducting Meta-Analyses in R with the metafor Package. 
<em>Journal of Statistical Software</em>. 2010; <b>36</b>. 
<a href="https://doi.org/10.18637/jss.v036.i03" class="external-link">doi:10.18637/jss.v036.i03</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="ccalc.html">ccalc</a></code> to calculate concordance statistics 
and corresponding standard errors, <code><a href="oecalc.html">oecalc</a></code> to calculate the 
total O:E ratio and corresponding standard errors, 
<code><a href="plot.valmeta.html">plot.valmeta</a></code> to generate forest plots</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">######### Validation of prediction models with a binary outcome #########</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">EuroSCORE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Meta-analysis of the c-statistic (random effects)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">valmeta</span><span class="op">(</span>cstat<span class="op">=</span><span class="va">c.index</span>, cstat.se<span class="op">=</span><span class="va">se.c.index</span>, cstat.cilb<span class="op">=</span><span class="va">c.index.95CIl</span>, </span></span>
<span class="r-in"><span>               cstat.ciub<span class="op">=</span><span class="va">c.index.95CIu</span>, cstat.cilv<span class="op">=</span><span class="fl">0.95</span>, N<span class="op">=</span><span class="va">n</span>, O<span class="op">=</span><span class="va">n.events</span>, </span></span>
<span class="r-in"><span>               slab<span class="op">=</span><span class="va">Study</span>, data<span class="op">=</span><span class="va">EuroSCORE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="valmeta-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Nearly identical results when we need to estimate the SE</span></span></span>
<span class="r-in"><span><span class="fu">valmeta</span><span class="op">(</span>cstat<span class="op">=</span><span class="va">c.index</span>,  N<span class="op">=</span><span class="va">n</span>, O<span class="op">=</span><span class="va">n.events</span>, slab<span class="op">=</span><span class="va">Study</span>, data<span class="op">=</span><span class="va">EuroSCORE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary c-statistic with 95% confidence and (approximate) 95% prediction interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Estimate       CIl       CIu       PIl       PIu </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.7889020 0.7650864 0.8109000 0.6818676 0.8669518 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of studies included:  23</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Two-stage meta-analysis of the total O:E ratio (random effects)</span></span></span>
<span class="r-in"><span><span class="fu">valmeta</span><span class="op">(</span>measure<span class="op">=</span><span class="st">"OE"</span>, O<span class="op">=</span><span class="va">n.events</span>, E<span class="op">=</span><span class="va">e.events</span>, N<span class="op">=</span><span class="va">n</span>, slab<span class="op">=</span><span class="va">Study</span>, data<span class="op">=</span><span class="va">EuroSCORE</span><span class="op">)</span>    </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary Total O:E ratio with 95% confidence and (approximate) 95% prediction interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Estimate       CIl       CIu       PIl       PIu </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.1075973 0.8998973 1.3632352 0.4295250 2.8561122 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of studies included:  23</span>
<span class="r-in"><span><span class="fu">valmeta</span><span class="op">(</span>measure<span class="op">=</span><span class="st">"OE"</span>, O<span class="op">=</span><span class="va">n.events</span>, E<span class="op">=</span><span class="va">e.events</span>, data<span class="op">=</span><span class="va">EuroSCORE</span><span class="op">)</span>       </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary Total O:E ratio with 95% confidence and (approximate) 95% prediction interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Estimate       CIl       CIu       PIl       PIu </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.1059784 0.8990028 1.3606056 0.4316383 2.8338269 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of studies included:  23</span>
<span class="r-in"><span><span class="fu">valmeta</span><span class="op">(</span>measure<span class="op">=</span><span class="st">"OE"</span>, Po<span class="op">=</span><span class="va">Po</span>, Pe<span class="op">=</span><span class="va">Pe</span>, N<span class="op">=</span><span class="va">n</span>, data<span class="op">=</span><span class="va">EuroSCORE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary Total O:E ratio with 95% confidence and (approximate) 95% prediction interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Estimate       CIl       CIu       PIl       PIu </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.1230955 0.9212978 1.3690944 0.4549877 2.7722586 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of studies included:  23</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># One-stage meta-analysis of the total O:E ratio (random effects)</span></span></span>
<span class="r-in"><span><span class="fu">valmeta</span><span class="op">(</span>measure<span class="op">=</span><span class="st">"OE"</span>, O<span class="op">=</span><span class="va">n.events</span>, E<span class="op">=</span><span class="va">e.events</span>, data<span class="op">=</span><span class="va">EuroSCORE</span>, method<span class="op">=</span><span class="st">"ML"</span>, </span></span>
<span class="r-in"><span>        pars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>model.oe<span class="op">=</span><span class="st">"poisson/log"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Bayesian random effects meta-analysis of the c-statistic</span></span></span>
<span class="r-in"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu">valmeta</span><span class="op">(</span>cstat<span class="op">=</span><span class="va">c.index</span>, cstat.se<span class="op">=</span><span class="va">se.c.index</span>, cstat.cilb<span class="op">=</span><span class="va">c.index.95CIl</span>,</span></span>
<span class="r-in"><span>                cstat.ciub<span class="op">=</span><span class="va">c.index.95CIu</span>, cstat.cilv<span class="op">=</span><span class="fl">0.95</span>, N<span class="op">=</span><span class="va">n</span>, O<span class="op">=</span><span class="va">n.events</span>, </span></span>
<span class="r-in"><span>                data<span class="op">=</span><span class="va">EuroSCORE</span>, method<span class="op">=</span><span class="st">"BAYES"</span>, slab<span class="op">=</span><span class="va">Study</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Bayesian one-stage random effects meta-analysis of the total O:E ratio</span></span></span>
<span class="r-in"><span><span class="co"># Consider that some (but not all) studies do not provide information on N</span></span></span>
<span class="r-in"><span><span class="co"># A Poisson distribution will be used for studies 1, 2, 5, 10 and 20</span></span></span>
<span class="r-in"><span><span class="co"># A Binomial distribution will be used for the remaining studies</span></span></span>
<span class="r-in"><span><span class="va">EuroSCORE.new</span> <span class="op">&lt;-</span> <span class="va">EuroSCORE</span></span></span>
<span class="r-in"><span><span class="va">EuroSCORE.new</span><span class="op">$</span><span class="va">n</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>hp.tau.dist<span class="op">=</span><span class="st">"dhalft"</span>,   <span class="co"># Prior for the between-study standard deviation</span></span></span>
<span class="r-in"><span>             hp.tau.sigma<span class="op">=</span><span class="fl">1.5</span>,       <span class="co"># Standard deviation for 'hp.tau.dist'</span></span></span>
<span class="r-in"><span>             hp.tau.df<span class="op">=</span><span class="fl">3</span>,            <span class="co"># Degrees of freedom for 'hp.tau.dist'</span></span></span>
<span class="r-in"><span>             hp.tau.max<span class="op">=</span><span class="fl">10</span>,          <span class="co"># Maximum value for the between-study standard deviation</span></span></span>
<span class="r-in"><span>             seed<span class="op">=</span><span class="fl">5</span><span class="op">)</span>                 <span class="co"># Set random seed for the simulations</span></span></span>
<span class="r-in"><span><span class="va">fit3</span> <span class="op">&lt;-</span> <span class="fu">valmeta</span><span class="op">(</span>measure<span class="op">=</span><span class="st">"OE"</span>, O<span class="op">=</span><span class="va">n.events</span>, E<span class="op">=</span><span class="va">e.events</span>, N<span class="op">=</span><span class="va">n</span>, data<span class="op">=</span><span class="va">EuroSCORE.new</span>,</span></span>
<span class="r-in"><span>        method<span class="op">=</span><span class="st">"BAYES"</span>, slab<span class="op">=</span><span class="va">Study</span>, pars<span class="op">=</span><span class="va">pars</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit3</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">model</span><span class="op">)</span> <span class="co"># Inspect the JAGS model</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit3</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">data</span><span class="op">)</span>  <span class="co"># Inspect the JAGS data</span></span></span>
<span class="r-in"><span><span class="op">}</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">######### Validation of prediction models with a time-to-event outcome #########</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Framingham</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Meta-analysis of total O:E ratio after 10 years of follow-up</span></span></span>
<span class="r-in"><span><span class="fu">valmeta</span><span class="op">(</span>measure<span class="op">=</span><span class="st">"OE"</span>, Po<span class="op">=</span><span class="va">Po</span>, Pe<span class="op">=</span><span class="va">Pe</span>, N<span class="op">=</span><span class="va">n</span>, data<span class="op">=</span><span class="va">Framingham</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>8 studies with NAs omitted from model fitting.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary Total O:E ratio with 95% confidence and (approximate) 95% prediction interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Estimate       CIl       CIu       PIl       PIu </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5781061 0.4400900 0.7594053 0.1935434 1.7267794 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of studies included:  16</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Thomas Debray, Valentijn de Jong.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

