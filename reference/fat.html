<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Regression tests for detecting funnel plot asymmetry — fat • metamisc</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Regression tests for detecting funnel plot asymmetry — fat"><meta name="description" content="The presence of small-study effects is a common threat to systematic reviews and meta-analyses, especially when
it is due to publication bias, which occurs when small primary studies are more likely to be reported (published)
if their findings were positive. The presence of small-study effects can be verified by visual inspection of
the funnel plot, where for each included study of the meta-analysis, the estimate of the reported effect size is
depicted against a measure of precision or sample size.
The premise is that the scatter of plots should reflect a funnel shape, if small-study
effects do not exist. However, when small studies are predominately in one direction (usually the
direction of larger effect sizes), asymmetry will ensue.
The fat function implements several tests for detecting funnel plot asymmetry,
which can be used when the presence of between-study heterogeneity in treatment effect is relatively low."><meta property="og:description" content="The presence of small-study effects is a common threat to systematic reviews and meta-analyses, especially when
it is due to publication bias, which occurs when small primary studies are more likely to be reported (published)
if their findings were positive. The presence of small-study effects can be verified by visual inspection of
the funnel plot, where for each included study of the meta-analysis, the estimate of the reported effect size is
depicted against a measure of precision or sample size.
The premise is that the scatter of plots should reflect a funnel shape, if small-study
effects do not exist. However, when small studies are predominately in one direction (usually the
direction of larger effect sizes), asymmetry will ensue.
The fat function implements several tests for detecting funnel plot asymmetry,
which can be used when the presence of between-study heterogeneity in treatment effect is relatively low."><meta property="og:image" content="https://smartdata-analysis-and-statistics.github.io/metamisc/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">metamisc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/ma-pf.html">Meta-analysis of prognostic factors</a></li>
    <li><a class="dropdown-item" href="../articles/ma-pm.html">Meta-analysis of prediction model performance</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/smartdata-analysis-and-statistics/metamisc/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Regression tests for detecting funnel plot asymmetry</h1>
      <small class="dont-index">Source: <a href="https://github.com/smartdata-analysis-and-statistics/metamisc/blob/main/R/fat.r" class="external-link"><code>R/fat.r</code></a></small>
      <div class="d-none name"><code>fat.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The presence of small-study effects is a common threat to systematic reviews and meta-analyses, especially when
it is due to publication bias, which occurs when small primary studies are more likely to be reported (published)
if their findings were positive. The presence of small-study effects can be verified by visual inspection of
the funnel plot, where for each included study of the meta-analysis, the estimate of the reported effect size is
depicted against a measure of precision or sample size.
The premise is that the scatter of plots should reflect a funnel shape, if small-study
effects do not exist. However, when small studies are predominately in one direction (usually the
direction of larger effect sizes), asymmetry will ensue.<br><br>
The <code>fat</code> function implements several tests for detecting funnel plot asymmetry,
which can be used when the presence of between-study heterogeneity in treatment effect is relatively low.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fat</span><span class="op">(</span><span class="va">b</span>, <span class="va">b.se</span>, <span class="va">n.total</span>, <span class="va">d.total</span>, <span class="va">d1</span>, <span class="va">d2</span>, method <span class="op">=</span> <span class="st">"E-FIV"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-b">b<a class="anchor" aria-label="anchor" href="#arg-b"></a></dt>
<dd><p>Vector with the effect size of each study. Examples are log odds ratio, log hazards ratio,
log relative risk.</p></dd>


<dt id="arg-b-se">b.se<a class="anchor" aria-label="anchor" href="#arg-b-se"></a></dt>
<dd><p>Optional vector with the standard error of the effect size of each study</p></dd>


<dt id="arg-n-total">n.total<a class="anchor" aria-label="anchor" href="#arg-n-total"></a></dt>
<dd><p>Optional vector with the total sample size of each study</p></dd>


<dt id="arg-d-total">d.total<a class="anchor" aria-label="anchor" href="#arg-d-total"></a></dt>
<dd><p>Optional vector with the total number of observed events for each study</p></dd>


<dt id="arg-d-">d1<a class="anchor" aria-label="anchor" href="#arg-d-"></a></dt>
<dd><p>Optional vector with the total number of observed events in the exposed groups</p></dd>


<dt id="arg-d-">d2<a class="anchor" aria-label="anchor" href="#arg-d-"></a></dt>
<dd><p>Optional vector with the total number of observed events in the unexposed groups</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Method for testing funnel plot asymmetry, defaults to <code>"E-FIV"</code> (Egger's test with
multiplicative dispersion). Other options are <code>E-UW</code>, <code>M-FIV</code>, <code>M-FPV</code>, <code>D-FIV</code> and
<code>D-FAV</code>. More info in "Details"</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a list containing the following entries:</p><dl><dt>"pval"</dt>
<dd><p>A two-sided P-value indicating statistical significance of the funnel plot asymettry test.
 Values below the significance level (usually defined as 10%) support the presence of funnel plot asymmetry,
 and thus small-study effects.</p></dd>

 <dt>"model"</dt>
<dd><p>A fitted <code>glm</code> object, representing the estimated regression model used for testing funnel
 plot asymmetry.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<div class="section">
<h3 id="egger-regression-method">Egger regression method<a class="anchor" aria-label="anchor" href="#egger-regression-method"></a></h3>
<p>A common approach to test the presence of small-study effects is to
estimate a regression model where the standardized effect estimate
(effect/SE) is regressed on a measure of precision (1/SE),
(<code>method="E-UW"</code>, Egger 1997).
It is possible to allow for between-study heterogeneity by adopting a
multiplicative overdispersion parameter by which the variance in each
study is multiplied (<code>method="E-FIV"</code>, Sterne 2000).</p>
<p>Unfortunately, it has been demonstrated that the aforementioned two tests
are biased because: (i) the independent variable is subject to sampling
variability; (ii) the standardized treatment effect is correlated with its
estimated precision; and (iii) for binary data, the independent regression
variable is a biased estimate of the true precision, with larger bias for
smaller sample sizes (Macaskill et al. 2001).</p>
</div>

<div class="section">
<h3 id="macaskill-regression-method">Macaskill regression method<a class="anchor" aria-label="anchor" href="#macaskill-regression-method"></a></h3>
<p>The standard approach estimates a regression model with the effect size as
a function of the study size (<code>method="M-FIV"</code>, Macaskill et al.
2001). Each study is weighted by the precision of the treatment effect
estimate to allow for possible heteroscedasticity.
An alternative approach is to weight each study by a pooled' estimate of the
outcome proportion (<code>method="M-FPV"</code>)</p>
<p>For studies with zero events, a continuity correction is applied by adding
0.5 to all cell counts.</p>
</div>

<div class="section">
<h3 id="peters-regression-method">Peters regression method<a class="anchor" aria-label="anchor" href="#peters-regression-method"></a></h3>
<p>This approach (<code>method="P-FPV"</code>) estimates a regression model with the
treatment effect as a function of the inverse of the total sample size
(Peters et al. 2006).</p>
<p>For studies with zero events, a continuity correction is applied by adding
0.5 to all cell counts.</p>
</div>

<div class="section">
<h3 id="debray-regression-method">Debray regression method<a class="anchor" aria-label="anchor" href="#debray-regression-method"></a></h3>
<p>This approach was proposed for survival data, and uses the total
number of events as independent variable in the weighted regression model
(Debray et al. 2017). The study weights are based on the inverse variance
(<code>method="D-FIV"</code>) or on an approximation thereof
(<code>method="D-FAV"</code>).</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Debray TPA, Moons KGM, Riley RD. Detecting small-study effects and funnel plot asymmetry in meta-analysis of
survival data: a comparison of new and existing tests. Res Syn Meth. 2018;9(1):41–50.<br><br>
Egger M, Davey Smith G, Schneider M, Minder C. Bias in meta-analysis detected by a simple, graphical test.
<em>BMJ</em>. 1997;315(7109):629–34. <br><br>
Macaskill P, Walter SD, Irwig L. A comparison of methods to detect publication bias in meta-analysis.
<em>Stat Med</em>. 2001;20(4):641–54.<br><br>
Peters JL, Sutton AJ, Jones DR, Abrams KR, Rushton L. Comparison of two methods to detect publication bias
in meta-analysis. <em>JAMA</em>. 2006 Feb 8;295(6):676–80.<br><br>
Sterne JA, Gavaghan D, Egger M. Publication and related bias in meta-analysis: power of statistical tests
and prevalence in the literature. <em>J Clin Epidemiol</em>. 2000;53(11):1119–29.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="plot.fat.html">plot.fat</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Thomas Debray &lt;thomas.debray@gmail.com&gt;</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Fibrinogen</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">Fibrinogen</span><span class="op">$</span><span class="va">HR</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">b.se</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">Fibrinogen</span><span class="op">$</span><span class="va">HR.975</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">Fibrinogen</span><span class="op">$</span><span class="va">HR.025</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n.total</span> <span class="op">&lt;-</span> <span class="va">Fibrinogen</span><span class="op">$</span><span class="va">N.total</span></span></span>
<span class="r-in"><span><span class="va">d.total</span> <span class="op">&lt;-</span> <span class="va">Fibrinogen</span><span class="op">$</span><span class="va">N.events</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">fat</span><span class="op">(</span>b<span class="op">=</span><span class="va">b</span>, b.se<span class="op">=</span><span class="va">b.se</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: fat(b = b, b.se = b.se)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fixed effect summary estimate:  0.4186  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> test for funnel plot asymmetry: t =1.9021, df = 29, p = 0.0671</span>
<span class="r-in"><span><span class="fu">fat</span><span class="op">(</span>b<span class="op">=</span><span class="va">b</span>, b.se<span class="op">=</span><span class="va">b.se</span>, d.total<span class="op">=</span><span class="va">d.total</span>, method<span class="op">=</span><span class="st">"D-FIV"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: fat(b = b, b.se = b.se, d.total = d.total, method = "D-FIV")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fixed effect summary estimate:  0.4186  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> test for funnel plot asymmetry: t =1.6847, df = 29, p = 0.1028</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note that many tests are also available via metafor</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://www.metafor-project.org" class="external-link">metafor</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: metafor</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: Matrix</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: metadat</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: numDeriv</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading the 'metafor' package (version 4.8-0). For an</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> introduction to the package please type: help(metafor)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘metafor’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:metamisc’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     forest, se</span>
<span class="r-in"><span><span class="fu">fat</span><span class="op">(</span>b<span class="op">=</span><span class="va">b</span>, b.se<span class="op">=</span><span class="va">b.se</span>, n.total<span class="op">=</span><span class="va">n.total</span>, method<span class="op">=</span><span class="st">"M-FIV"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: fat(b = b, b.se = b.se, n.total = n.total, method = "M-FIV")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fixed effect summary estimate:  0.4186  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> test for funnel plot asymmetry: t =-1.4275, df = 29, p = 0.1641</span>
<span class="r-in"><span><span class="fu"><a href="https://wviechtb.github.io/metafor/reference/regtest.html" class="external-link">regtest</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">b</span>, sei<span class="op">=</span><span class="va">b.se</span>, ni<span class="op">=</span><span class="va">n.total</span>, model<span class="op">=</span><span class="st">"lm"</span>, predictor<span class="op">=</span><span class="st">"ni"</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regression Test for Funnel Plot Asymmetry</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model:     weighted regression with multiplicative dispersion</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Predictor: sample size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test for Funnel Plot Asymmetry: t = -1.4275, df = 29, p = 0.1641</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Debray, Valentijn de Jong.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

